<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Свалка</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: sans-serif;
      overflow: hidden;
    }
    #text {
      padding: 20px;
      font-size: 20px;
      line-height: 1.5;
      position: relative;
      z-index: 1;
    }
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      pointer-events: none;
    }
    .word {
      display: inline-block;
      white-space: pre;
    }
  </style>
</head>
<body>
  <div id="text">
Стянув нитку с плеч твоих,
Я, закрыв глаза, танцую,
На коленках, обмотавшись, в простыню свою, твержу:
Если вдруг вернёшься снова, если сдуру скажешь слово,
Скоро я сломаю тело, что ношу с собой, прошу,
Если вдруг ты не вернёшься, тело вывернет наружу и захватит власть над смелым и докажет мне урок,
Я прошу,
Прошу по-злому:
Возвращайся с сворой, в пору,
Пропади на век, опорой
Посчитаю смех сорóк. отголоски лета
от голых скелетом
сбегает на свой парапет
пары лет не хватило
чтобы колом с кометы
размахнуться 
своей порой бед
впарил бред и рад 
дарит
яро улыбку 
девочка с кленовым взглядом
я роль 
зыбку
тащу налегке
а хотелось просто быть 
кряду
сотни и сотни и сотни
там лет
тысячи тысячи
"Нет." Топор тех эпох так плох, что -
 то бор для души. 
Не решил,
Кто из нас, крох и машин,
Такой мох,
Чтобы выжить в чужих холодах,
То пор
Дыхание расчувствовало меня, ах!
День изо дня проволок,
Потолок
- он с тех пор,
С техпромконгломерат снующих коров
 всё тусуется.
Какие были прекрасные улицы - пока не равен был наш
Размах
Рук,
Пока неровен был наш пробор,
Прибор
Порук
Глубоко возгресился сызмала.
Нам остаётся лишь лаять и тлеть.

А мы тут всё псы, зола.Такой одинокий тенёк, тень ног, о тин ока запутался, будто чей-то щенок, день мог
 бы оказаться чуть лучше, чем смог,
Бык-рок озаряться,
Блик от озираться,
Тел тока,
Дел только,
Тем толку -
Нам всем собираться,
На сень побираться,
Тем столько - осколком, а сколько?
Ас колко
Пикирует вниз в тишине.
  </div>
  <canvas id="world"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
  <script>
    const { Engine, Render, Runner, Bodies, World, Body, Events } = Matter;

    const engine = Engine.create();
    const world = engine.world;
    engine.gravity.y = 1.8;
    engine.timing.timeScale = 1.2;

    const canvas = document.getElementById("world");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const render = Render.create({
      canvas: canvas,
      engine: engine,
      options: {
        width: window.innerWidth,
        height: window.innerHeight,
        background: "transparent",
        wireframes: false
      }
    });

    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    const ground = Bodies.rectangle(
      window.innerWidth / 2, 
      window.innerHeight + 30, 
      window.innerWidth, 
      60, 
      { isStatic: true }
    );
    World.add(world, ground);

    // Разбиваем текст на span'ы
    const textDiv = document.getElementById("text");
    const words = textDiv.innerText.split(/(\s+)/);
    textDiv.innerHTML = "";
    words.forEach(w => {
      const span = document.createElement("span");
      span.textContent = w;
      if (w.trim() !== "") span.classList.add("word");
      textDiv.appendChild(span);
    });

    // Создание тел через requestAnimationFrame, чтобы гарантировать правильные позиции
    requestAnimationFrame(() => {
      const bodies = [];
      document.querySelectorAll(".word").forEach(span => {
        const x = span.offsetLeft + span.offsetWidth / 2;
        const y = span.offsetTop + span.offsetHeight / 2;
        const body = Bodies.rectangle(
          x,
          y,
          span.offsetWidth,
          span.offsetHeight,
          {
            restitution: 0.65,
            friction: 0.05,
            render: { fillStyle: "black" }
          }
        );
        body.label = span.textContent;

        Body.applyForce(body, body.position, {
          x: (Math.random() - 0.5) * 0.02,
          y: Math.random() * 0.03
        });

        World.add(world, body);
        bodies.push({ body, span });

        span.style.visibility = "hidden";
      });

      // Рисуем слова поверх тел
      (function draw() {
        const ctx = render.context;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white";
        ctx.font = "20px sans-serif";
        ctx.textBaseline = "middle";
        bodies.forEach(({ body }) => {
          ctx.save();
          ctx.translate(body.position.x, body.position.y);
          ctx.rotate(body.angle);
          ctx.fillText(body.label, -body.label.length * 6, 0);
          ctx.restore();
        });
        requestAnimationFrame(draw);
      })();
    });
  </script>
</body>
</html>
